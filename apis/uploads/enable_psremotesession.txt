
#PowerShell on  Remoting Server
#Windows Server 2008 R2 enabling Remoting  manual 

#On Remote Server
Enable-PSRemoting -Force

Set-Item WSMan:\localhost\Service\AllowUnencrypted -Value True
Set-Item WSMan:\localhost\Service\Auth\Basic -Value True

#On Local Server

Set-Item WSMan:\localhost\Client\TrustedHosts -Value "192.168.1.100"

Set-Item WSMan:\localhost\Client\TrustedHosts -Value "192.168.1.100,192.168.1.101"

Set-Item WSMan:\localhost\Client\TrustedHosts -Value "*"


#Establishing remoteing Session on local Control Client

Invoke-Command -ComputerName 192.168.1.100 -ScriptBlock { Get-Service } -Credential (Get-Credential)

Enter-PSSession -ComputerName 192.168.1.100 -Credential (Get-Credential)```

Exit-PSSession

#Establish Permentment remoteing Session on local Control Client

$s = New-PSSession -ComputerName 192.168.1.100 -Credential (Get-Credential)
Invoke-Command -Session $s -ScriptBlock { hostname; Get-Date }
Remove-PSSession $s

#Testing Connection

Test-WsMan 192.168.1.100
